{"version":3,"file":"popup.js","mappings":"44DAAC,WACG,aA+BA,GA7BAA,OAAOC,UACFC,MAAK,WAIEC,SAASC,eAAe,eACxBD,SAASC,eAAe,aAAaC,QAAUC,GAE/CH,SAASC,eAAe,yBACxBD,SAASC,eAAe,uBAAuBC,QAAUE,GAGzDJ,SAASC,eAAe,mBACxBD,SAASC,eAAe,iBAAiBC,QAAUG,GAGnDL,SAASC,eAAe,iBACxBD,SAASC,eAAe,eAAeC,QAAUI,GAGjDN,SAASC,eAAe,iBACxBD,SAASC,eAAe,eAAeC,QAAUK,MAQzDC,EAAE,SAASC,OAAS,EAAG,CACvB,IADuB,MACL,IAAIC,gBAAgBC,SAASC,SADxB,IAEvB,2BAAsC,oBAA1BC,EAA0B,KAArBC,EAAqB,KAElC,GAAW,MAAPD,EAAa,CACbE,EAAYD,GACZ,QANe,+BAhClB,SA0CMC,EA1CN,mFA0CT,WAA2BD,GAA3B,gGACUE,MAAM,6CAAD,OAA8CF,IACpDf,MAAK,SAACkB,GAAD,OAASA,EAAIC,UAClBnB,MAAK,SAAAoB,GAEFC,QAAQC,IAAIF,GAFF,UAGIA,GAHJ,IAGV,2BAAoB,KAAXG,EAAW,QAGZC,EAAU,sFAAH,OACgDD,EAAEE,GADlD,oBACgEF,EAAEE,GADlE,8DAEkBF,EAAEE,GAFpB,aAE2BF,EAAEG,KAF7B,mDAKXjB,EAAE,eAAekB,OAAOH,IAXlB,kCAHtB,2CA1CS,yEAiET,6GACUI,EAAY,IAAIjB,gBAAgBC,SAASC,QADnD,IAG+Be,GAH/B,2EAGgBd,EAHhB,KAGqBC,EAHrB,KAKmB,MAAPD,EALZ,iCAMkBe,EAAoBd,GANtC,wBAOkBe,EAAYf,GAP9B,4OAjES,+BA8EMe,EA9EN,mFA8ET,WAA2Bf,GAA3B,gGACUE,MAAM,2CAAD,OAA4CF,IAClDf,MAAK,SAACkB,GAAD,OAASA,EAAIC,UAClBnB,MAAK,SAAAoB,GAEFC,QAAQC,IAAIF,GAFF,UAGIA,GAHJ,IAGV,2BAAoB,KAAXG,EAAW,QAGZC,EAAU,kFAAH,OAC4CD,EAAEE,GAD9C,oBAC4DF,EAAEE,GAD9D,4DAEgBF,EAAEE,GAFlB,aAEyBF,EAAEG,KAF3B,mDAIXjB,EAAE,aAAakB,OAAOH,IAVhB,kCAHtB,2CA9ES,iCAgGMK,EAhGN,mFAgGT,WAAmCd,GAAnC,gGACUE,MAAM,sCAAD,OAAuCF,IAC7Cf,MAAK,SAACkB,GAAD,OAASA,EAAIC,UAClBnB,MAAK,SAAAoB,GAEFC,QAAQC,IAAIF,GACZX,EAAE,gBAAgBsB,KAAKX,EAAK,GAAGM,SAN3C,2CAhGS,wBAkHT,SAAStB,IACL,IAAM4B,EAAa/B,SAASgC,cAAc,qCAAqClB,MAC/EjB,OAAOoC,QAAQC,GAAGC,cAAcJ,GAGpC,SAAS3B,IACL,IAAMgC,EAAoBpC,SAASgC,cAAc,0CAA0ClB,MAC3FjB,OAAOoC,QAAQC,GAAGC,cAAcC,GAIpC,SAAS/B,IACL,IAAMgC,EAAmBrC,SAASgC,cAAc,oCAAoClB,MACpFjB,OAAOoC,QAAQC,GAAGC,cAAcE,GAIpC,SAAS/B,IACL,IAAMgC,EAAkBtC,SAASC,eAAe,cAAca,MACxDyB,EAAmBvC,SAASC,eAAe,eAAea,MAChEjB,OAAOoC,QAAQC,GAAGC,cAAcG,EAAkB,IAAMC,GAG5D,SAAShC,IACL,IAAMiC,EAAiBxC,SAASgC,cAAc,kCAAkClB,MAChFjB,OAAOoC,QAAQC,GAAGC,cAAcK,GA7EhChC,EAAE,aAAaC,OAAS,GA9DnB,mCA+DLgC,GA/DP,G","sources":["webpack:///./src/dialogs/popup.js?"],"sourcesContent":["(function () {\r\n    \"use strict\";\r\n\r\n    Office.onReady()\r\n        .then(function () {\r\n\r\n            // TODO1: Assign handler to the OK button.\r\n            // console.log(document.getElementById(\"ok-button\"))\r\n            if (document.getElementById(\"ok-button\")) {\r\n                document.getElementById(\"ok-button\").onclick = sendTypeReportToParentPage;\r\n            }\r\n            if (document.getElementById(\"productplant-button\")) {\r\n                document.getElementById(\"productplant-button\").onclick = sendProductPlantToParentPage;\r\n            }\r\n            // console.log(document.getElementById(\"ok-button\"))\r\n            if (document.getElementById(\"worker-button\")) {\r\n                document.getElementById(\"worker-button\").onclick = sendIdWorkerToParentPage;\r\n            }\r\n\r\n            if (document.getElementById(\"date-button\")) {\r\n                document.getElementById(\"date-button\").onclick = sendTimeToParentPage;\r\n            }\r\n\r\n            if (document.getElementById(\"task-button\")) {\r\n                document.getElementById(\"task-button\").onclick = sendTaskToParentPage;\r\n            }\r\n\r\n        });\r\n\r\n\r\n    // document.getElementById(\"test\").innerHTML = \"Do Cong kien\"\r\n    // $(\"#test\").text(\"Hello Jquery\")\r\n    if ($(\"#abcd\").length > 0) {\r\n        const urlParams = new URLSearchParams(location.search);\r\n        for (const [key, value] of urlParams) {\r\n            // console.log(`${key}:${value}`);\r\n            if (key == \"id\") {\r\n                getListUser(value)\r\n                break\r\n            }\r\n        }\r\n    }\r\n    async function getListUser(value) {\r\n        await fetch(`http://localhost:8080/productplant/worker/${value}`)\r\n            .then((res) => res.json())\r\n            .then(data => {\r\n                //hiển thị data( danh sách các phân xưởng) ra list\r\n                console.log(data)\r\n                for (let i of data) {\r\n                    // console.log($(\"#productPlantList\"))\r\n                    // console.log(i.name)\r\n                    let element = `<li>\r\n                        <input type=\"radio\" name=\"workerName\" id=\"workerItem-${i.id}\" value=\"${i.id}\">\r\n                        <label for=\"workerItem-${i.id}\">${i.name}</label>\r\n                                </li>`\r\n                    // console.log(element)\r\n                    $(\"#workerList\").append(element)\r\n                }\r\n                // console.log(\"1\")\r\n            });\r\n    }\r\n\r\n    if ($(\"#taskList\").length > 0) {\r\n        popupTask()\r\n    }\r\n    async function popupTask() {\r\n        const urlParams = new URLSearchParams(location.search);\r\n        \r\n        for (const [key, value] of urlParams) {\r\n            // console.log(`${key}:${value}`);\r\n            if (key == \"id\") {\r\n                await getProductPlantById(value)\r\n                await getListTask(value)\r\n                break\r\n            }\r\n        }\r\n    }\r\n\r\n    async function getListTask(value) {\r\n        await fetch(`http://localhost:8080/productplant/task/${value}`)\r\n            .then((res) => res.json())\r\n            .then(data => {\r\n                //hiển thị data( danh sách các phân xưởng) ra list\r\n                console.log(data)\r\n                for (let i of data) {\r\n                    // console.log($(\"#productPlantList\"))\r\n                    // console.log(i.name)\r\n                    let element = `<li>\r\n                        <input type=\"radio\" name=\"taskName\" id=\"taskItem-${i.id}\" value=\"${i.id}\">\r\n                        <label for=\"taskItem-${i.id}\">${i.name}</label>\r\n                                </li>`\r\n                    $(\"#taskList\").append(element)\r\n                }\r\n            });\r\n    }\r\n\r\n    async function getProductPlantById(value) {\r\n        await fetch(`http://localhost:8080/productplant/${value}`)\r\n            .then((res) => res.json())\r\n            .then(data => {\r\n                //hiển thị data( danh sách các phân xưởng) ra list\r\n                console.log(data)\r\n                $(\"#popup__task\").text(data[0].name)\r\n            });\r\n    }\r\n\r\n    \r\n\r\n\r\n\r\n\r\n    // document.getElementById(\"abcd\").innerHTML = localStorage.getItem(\"clientID\")\r\n\r\n    // TODO2: Create the OK button handler\r\n    function sendTypeReportToParentPage() {\r\n        const typeReport = document.querySelector('input[name=\"type_report\"]:checked').value;\r\n        Office.context.ui.messageParent(typeReport);\r\n    }\r\n\r\n    function sendProductPlantToParentPage() {\r\n        const productPlantValue = document.querySelector('input[name=\"productPlantName\"]:checked').value;\r\n        Office.context.ui.messageParent(productPlantValue);\r\n    }\r\n\r\n\r\n    function sendIdWorkerToParentPage() {\r\n        const id_worker_dialog = document.querySelector('input[name=\"workerName\"]:checked').value;\r\n        Office.context.ui.messageParent(id_worker_dialog);\r\n    }\r\n\r\n\r\n    function sendTimeToParentPage() {\r\n        const timeValueDialog = document.getElementById(\"time-input\").value;\r\n        const timeValueDialog2 = document.getElementById(\"time-input2\").value;\r\n        Office.context.ui.messageParent(timeValueDialog + \" \" + timeValueDialog2);\r\n    }\r\n\r\n    function sendTaskToParentPage() {\r\n        const id_task_dialog = document.querySelector('input[name=\"taskName\"]:checked').value;\r\n        Office.context.ui.messageParent(id_task_dialog);\r\n    }\r\n    \r\n\r\n\r\n\r\n\r\n}());"],"names":["Office","onReady","then","document","getElementById","onclick","sendTypeReportToParentPage","sendProductPlantToParentPage","sendIdWorkerToParentPage","sendTimeToParentPage","sendTaskToParentPage","$","length","URLSearchParams","location","search","key","value","getListUser","fetch","res","json","data","console","log","i","element","id","name","append","urlParams","getProductPlantById","getListTask","text","typeReport","querySelector","context","ui","messageParent","productPlantValue","id_worker_dialog","timeValueDialog","timeValueDialog2","id_task_dialog","popupTask"],"sourceRoot":""}