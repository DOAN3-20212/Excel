!function(){function e(e,n){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,n){if(e){if("string"==typeof e)return t(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){o&&(e=o);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==o.return||o.return()}finally{if(s)throw i}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function n(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise((function(r,a){var i=e.apply(t,o);function c(e){n(i,r,a,c,s,"next",e)}function s(e){n(i,r,a,c,s,"throw",e)}c(void 0)}))}}function r(e){return a.apply(this,arguments)}function a(){return a=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=t){e.next=7;break}return e.next=3,s();case 3:return e.next=5,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){var n,o,r,a,i,c,s,l,g,u,f,m,d,h,p,y,v,x,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),o=n.getRange("A1:B1"),r=n.getRange("E1:H1"),a=n.getRange("E2:H2"),i=n.getRange("B5:G6"),c=n.getRange("A2:C2"),s=new Date,l="Ngày ".concat(s.getDate()," Tháng ").concat(s.getMonth()," Năm ").concat(s.getFullYear()),r.merge(),a.merge(),o.merge(),i.merge(),c.merge(),g=n.getRange("A1"),u=n.getRange("E1"),f=n.getRange("E2"),m=n.getRange("B5"),n.getRange("A2").values=[["".concat(l)]],g.values=[["Công ty Rạng Đông"]],u.values=[["Cộng hòa xã hội chủ nghĩa Việt Nam"]],f.values=[["Độc lập - Tự do - Hạnh phúc"]],m.values=[["BÁO CÁO SẢN XUẤT CÔNG NHÂN"]],u.format.horizontalAlignment="Center",f.format.horizontalAlignment="Center",g.format.horizontalAlignment="Left",m.format.horizontalAlignment="Center",m.format.font.bold=!0,m.format.font.size=18,d=n.getRange("B9"),h=n.getRange("F9"),p=n.getRange("B10"),y=n.getRange("D10"),v=n.getRange("D9"),x=n.getRange("F19"),d.values=[["Họ và tên:"]],h.values=[["Phân xưởng:"]],p.values=[["Từ ngày:"]],y.values=[["Đến ngày:"]],v.values=[["Mã nhân viên:"]],x.values=[["Người lập báo cáo"]],d.format.horizontalAlignment="Left",d.format.font.size=12,d.format.font.italic=!0,x.format.horizontalAlignment="Left",x.format.font.size=12,x.format.font.italic=!0,v.format.horizontalAlignment="Left",v.format.font.size=12,v.format.font.italic=!0,h.format.horizontalAlignment="Left",h.format.font.size=12,h.format.font.italic=!0,p.format.horizontalAlignment="Left",p.format.font.size=12,p.format.font.italic=!0,y.format.horizontalAlignment="Left",y.format.font.size=12,y.format.font.italic=!0,(R=n.tables.add("B12:G12",!0)).name="ReportData",R.getHeaderRowRange().values=[["STT","Mã Công Việc","Tên Công Việc","Tổng chỉ tiêu","Sản phẩm đạt","Sản phẩm lỗi"]],R.getHeaderRowRange().format.fill.color="#009879",R.getDataBodyRange().format.fill.color="#FFFFFF",Office.context.requirements.isSetSupported("ExcelApi","1.2")&&(n.getUsedRange().format.autofitColumns(),n.getUsedRange().format.autofitRows(),n.getUsedRange().format.horizontalAlignment="Center"),n.getRange("A2").format.horizontalAlignment="Left",n.getRange("A2").format.font.italic=!0,e.next=68,t.sync();case 68:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 5:e.next=12;break;case 7:if(2!=t){e.next=12;break}return e.next=10,s();case 10:return e.next=12,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){var n,o,r,a,i,c,s,l,g,u,f,m,d,h,p,y,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),o=n.getRange("A1:B1"),r=n.getRange("E1:H1"),a=n.getRange("E2:H2"),i=n.getRange("B5:G6"),c=n.getRange("A2:C2"),s=new Date,l="Ngày ".concat(s.getDate()," Tháng ").concat(s.getMonth()," Năm ").concat(s.getFullYear()),r.merge(),a.merge(),o.merge(),i.merge(),c.merge(),g=n.getRange("A1"),u=n.getRange("E1"),f=n.getRange("E2"),m=n.getRange("B5"),n.getRange("A2").values=[["".concat(l)]],g.values=[["Công ty Rạng Đông"]],u.values=[["Cộng hòa xã hội chủ nghĩa Việt Nam"]],f.values=[["Độc lập - Tự do - Hạnh phúc"]],m.values=[["BÁO CÁO SẢN XUẤT PHÂN XƯỞNG"]],u.format.horizontalAlignment="Center",f.format.horizontalAlignment="Center",g.format.horizontalAlignment="Left",m.format.horizontalAlignment="Center",m.format.font.bold=!0,m.format.font.size=18,d=n.getRange("B9"),h=n.getRange("B10"),p=n.getRange("D10"),y=n.getRange("F19"),d.values=[["Phân xưởng"]],h.values=[["Từ ngày:"]],p.values=[["Đến ngày:"]],y.values=[["Người lập báo cáo"]],d.format.horizontalAlignment="Left",d.format.font.size=12,d.format.font.italic=!0,y.format.horizontalAlignment="Left",y.format.font.size=12,y.format.font.italic=!0,h.format.horizontalAlignment="Left",h.format.font.size=12,h.format.font.italic=!0,p.format.horizontalAlignment="Left",p.format.font.size=12,p.format.font.italic=!0,(v=n.tables.add("B12:G12",!0)).name="ReportData",v.getHeaderRowRange().values=[["STT","Mã Công Việc","Tên Công Việc","Tổng chỉ tiêu","Sản phẩm đạt","Sản phẩm lỗi"]],v.getHeaderRowRange().format.fill.color="#009879",v.getDataBodyRange().format.fill.color="#FFFFFF",Office.context.requirements.isSetSupported("ExcelApi","1.2")&&(n.getUsedRange().format.autofitColumns(),n.getUsedRange().format.autofitRows(),n.getUsedRange().format.horizontalAlignment="Center"),n.getRange("A2").format.horizontalAlignment="Left",n.getRange("A2").format.font.italic=!0,e.next=58,t.sync();case 58:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 12:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}function i(){return c.apply(this,arguments)}function c(){return c=o(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Excel.run(function(){var t=o(regeneratorRuntime.mark((function t(n){var o,r,a,i,c,s,l,g,u,f,m,d,h,p,y,v,x,R,E;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=document.getElementById("id_worker_taskpane").innerHTML,r=document.getElementById("abc").innerHTML,a=document.getElementById("time_taskpane").innerHTML,i=document.getElementById("user-name").innerHTML){t.next=9;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 9:if("Báo cáo sản xuất công nhân"!=i){t.next=15;break}if(o&&a){t.next=13;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 13:t.next=22;break;case 15:if("Báo cáo sản xuất phân xưởng"!=i){t.next=21;break}if(r&&a){t.next=19;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 19:t.next=22;break;case 21:return t.abrupt("return");case 22:return document.querySelector(".taskpane__error").innerHTML="",c=n.workbook.worksheets.getActiveWorksheet(),s=[],(l=c.getUsedRange()).load("values"),t.next=29,n.sync();case 29:g=/^[\{]([a-z]|[0-9]|\(|\)|\-|\_)+[\}]$/,u=e(l.values);try{for(u.s();!(f=u.n()).done;){m=f.value,d=e(m);try{for(d.s();!(h=d.n()).done;)p=h.value,g.test(p)&&s.push(p)}catch(e){d.e(e)}finally{d.f()}}}catch(e){u.e(e)}finally{u.f()}if(y=[],"Báo cáo sản xuất công nhân"!=i){t.next=39;break}return v={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({worker:o,time:a,dataClient:s})},t.next=37,fetch("http://localhost:8080/data",v).then((function(e){return e.text()})).then((function(e){console.log("Giá trị Server trả về là : "+e),y.push(JSON.parse(e))}));case 37:t.next=42;break;case 39:return x={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({productplant:r,time:a,dataClient:s})},t.next=42,fetch("http://localhost:8080/data",x).then((function(e){return e.text()})).then((function(e){console.log("Giá trị Server trả về là : "+e),y.push(JSON.parse(e))}));case 42:console.log("Excel nhận được sau khi fetch xong: "+y),R=0;case 44:if(!(R<y[0].length)){t.next=60;break}return(E=l.find("{".concat(y[0][R].data,"}"),{completeMatch:!0,matchCase:!1,searchDirection:Excel.SearchDirection.forward})).load("address"),t.next=49,n.sync();case 49:if(!E.address){t.next=56;break}return E.values=[["".concat(y[0][R].value)]],E.format.autofitColumns(),t.next=54,n.sync();case 54:t.next=57;break;case 56:return t.abrupt("break",60);case 57:R++,t.next=44;break;case 60:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 2:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function s(){return l.apply(this,arguments)}function l(){return l=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.workbook.worksheets.getActiveWorksheet().getRange().clear(),e.next=4,t.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 2:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}Office.onReady((function(e){var t,n,o,a,c,l,g,f,m;e.host===Office.HostType.Excel&&function(){for(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",Office.context.requirements.isSetSupported("ExcelApi","1.7")||console.log("Sorry. The tutorial add-in uses Excel.js APIs that are not available in your version of Office."),t=document.getElementsByClassName("custom-select"),a=t.length,n=0;n<a;n++){for(l=t[n].getElementsByTagName("select")[0],c=l.length,(g=document.createElement("DIV")).setAttribute("class","select-selected"),g.innerHTML=l.options[l.selectedIndex].innerHTML,t[n].appendChild(g),(f=document.createElement("DIV")).setAttribute("class","select-items select-hide"),o=1;o<c;o++)(m=document.createElement("DIV")).innerHTML=l.options[o].innerHTML,m.addEventListener("click",(function(e){var t,n,o,a,i,c,s,l=$(".select-selected").text().trim();for(c=(a=this.parentNode.parentNode.getElementsByTagName("select")[0]).length,i=this.parentNode.previousSibling,n=0;n<c;n++)if(a.options[n].innerHTML==this.innerHTML){for(a.selectedIndex=n,i.innerHTML=this.innerHTML,s=(t=this.parentNode.getElementsByClassName("same-as-selected")).length,o=0;o<s;o++)t[o].removeAttribute("class");this.setAttribute("class","same-as-selected");break}i.click();var g=document.querySelector(".custom-select select"),u=g.options[g.selectedIndex].text;console.log(u),l!=u&&r(g.value)})),f.appendChild(m);t[n].appendChild(f),g.addEventListener("click",(function(t){t.stopPropagation(),e(this),this.nextSibling.classList.toggle("select-hide"),this.classList.toggle("select-arrow-active")}))}function e(e){var t,n,o,r,a,i=[];for(t=document.getElementsByClassName("select-items"),n=document.getElementsByClassName("select-selected"),r=t.length,a=n.length,o=0;o<a;o++)e==n[o]?i.push(o):n[o].classList.remove("select-arrow-active");for(o=0;o<r;o++)i.indexOf(o)&&t[o].classList.add("select-hide")}document.addEventListener("click",e),document.getElementById("clear-table").onclick=s,document.getElementById("connect-db").onclick=i,document.getElementById("open-dialog").onclick=u}()}));var g=null;function u(){Office.context.ui.displayDialogAsync("https://localhost:3000/popup.html",{height:45,width:55},(function(e){(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,f)}))}function f(e){"worker"==e.message?document.getElementById("user-name").innerHTML="Báo cáo sản xuất công nhân":"productplant"==e.message?document.getElementById("user-name").innerHTML="Báo cáo sản xuất phân xưởng":document.getElementById("user-name").innerHTML="Báo cáo sản xuất sản phẩm",g.close(),m()}function m(){Office.context.ui.displayDialogAsync("https://localhost:3000/ProductPlant.html",{width:50,height:50},(function(e){e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó"),m()),console.log("Mở dialog 2 thành công"),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,d)}))}function d(e){document.getElementById("abc").innerHTML=e.message,g.close();var t=document.getElementById("user-name").innerHTML;if("Báo cáo sản xuất công nhân"==t)console.log("else 1"),h();else{if("Báo cáo sản xuất phân xưởng"!=t)return;console.log("Chuẩn bị mở dialog lấy thời gian"),y()}}function h(){var e=document.getElementById("abc").innerHTML;Office.context.ui.displayDialogAsync("https://localhost:3000/Worker.html?id=".concat(e),{width:50,height:50},(function(e){e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó ở Dialog Worker"),h()),console.log("Mở dialog 3 thành công"),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,p),console.log("Nhận event Dialog Worker")}))}function p(e){console.log("test hàm dialog 3"),document.getElementById("id_worker_taskpane").innerHTML=e.message,g.close(),y()}function y(){Office.context.ui.displayDialogAsync("https://localhost:3000/Date.html?",{width:50,height:50},(function(e){console.log("Chạy vào hàm mở dialog 4"),e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó ở Dialog Time"),y()),console.log("Mở dialog 4 thành công"),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,v)}))}function v(e){console.log("test hàm dialog 4"),console.log(e.message),document.getElementById("time_taskpane").innerHTML=e.message,g.close()}}();
//# sourceMappingURL=taskpane.js.map