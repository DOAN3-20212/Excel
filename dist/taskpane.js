!function(){function e(e,n){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,n){if(e){if("string"==typeof e)return t(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){o&&(e=o);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return c=e.done,e},e:function(e){l=!0,i=e},f:function(){try{c||null==o.return||o.return()}finally{if(l)throw i}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function n(e,t,n,o,r,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise((function(r,a){var i=e.apply(t,o);function c(e){n(i,r,a,c,l,"next",e)}function l(e){n(i,r,a,c,l,"throw",e)}c(void 0)}))}}function r(){return r=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=t){e.next=7;break}return e.next=3,c();case 3:return e.next=5,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){var n,o,r,a,i,c,l,g,s,f,u,m,h,d,p,y,v,R,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),o=n.getRange("A1:B1"),r=n.getRange("E1:H1"),a=n.getRange("E2:H2"),i=n.getRange("B5:G6"),c=n.getRange("A2:C2"),l=new Date,g="Ngày ".concat(l.getDate()," Tháng ").concat(l.getMonth()," Năm ").concat(l.getFullYear()),r.merge(),a.merge(),o.merge(),i.merge(),c.merge(),s=n.getRange("A1"),f=n.getRange("E1"),u=n.getRange("E2"),m=n.getRange("B5"),n.getRange("A2").values=[["".concat(g)]],s.values=[["Công ty Rạng Đông"]],f.values=[["Cộng hòa xã hội chủ nghĩa Việt Nam"]],u.values=[["Độc lập - Tự do - Hạnh phúc"]],m.values=[["BÁO CÁO SẢN XUẤT CÔNG NHÂN"]],f.format.horizontalAlignment="Center",u.format.horizontalAlignment="Center",s.format.horizontalAlignment="Left",m.format.horizontalAlignment="Center",m.format.font.bold=!0,m.format.font.size=18,h=n.getRange("B9"),d=n.getRange("F9"),p=n.getRange("B10"),y=n.getRange("D10"),v=n.getRange("D9"),R=n.getRange("F19"),h.values=[["Họ và tên:"]],d.values=[["Phân xưởng:"]],p.values=[["Từ ngày:"]],y.values=[["Đến ngày:"]],v.values=[["Mã nhân viên:"]],R.values=[["Người lập báo cáo"]],h.format.horizontalAlignment="Left",h.format.font.size=12,h.format.font.italic=!0,R.format.horizontalAlignment="Left",R.format.font.size=12,R.format.font.italic=!0,v.format.horizontalAlignment="Left",v.format.font.size=12,v.format.font.italic=!0,d.format.horizontalAlignment="Left",d.format.font.size=12,d.format.font.italic=!0,p.format.horizontalAlignment="Left",p.format.font.size=12,p.format.font.italic=!0,y.format.horizontalAlignment="Left",y.format.font.size=12,y.format.font.italic=!0,(x=n.tables.add("B12:G12",!0)).name="ReportData",x.getHeaderRowRange().values=[["STT","Mã Công Việc","Tên Công Việc","Tổng chỉ tiêu","Sản phẩm đạt","Sản phẩm lỗi"]],x.getHeaderRowRange().format.fill.color="#009879",x.getDataBodyRange().format.fill.color="#FFFFFF",Office.context.requirements.isSetSupported("ExcelApi","1.2")&&(n.getUsedRange().format.autofitColumns(),n.getUsedRange().format.autofitRows(),n.getUsedRange().format.horizontalAlignment="Center"),n.getRange("A2").format.horizontalAlignment="Left",n.getRange("A2").format.font.italic=!0,e.next=68,t.sync();case 68:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 5:case 12:e.next=18;break;case 7:if(2!=t){e.next=14;break}return e.next=10,c();case 10:return e.next=12,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){var n,o,r,a,i,c,l,g,s,f,u,m,h,d,p,y,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),o=n.getRange("A1:B1"),r=n.getRange("E1:H1"),a=n.getRange("E2:H2"),i=n.getRange("B5:G6"),c=n.getRange("A2:C2"),l=new Date,g="Ngày ".concat(l.getDate()," Tháng ").concat(l.getMonth()," Năm ").concat(l.getFullYear()),r.merge(),a.merge(),o.merge(),i.merge(),c.merge(),s=n.getRange("A1"),f=n.getRange("E1"),u=n.getRange("E2"),m=n.getRange("B5"),n.getRange("A2").values=[["".concat(g)]],s.values=[["Công ty Rạng Đông"]],f.values=[["Cộng hòa xã hội chủ nghĩa Việt Nam"]],u.values=[["Độc lập - Tự do - Hạnh phúc"]],m.values=[["BÁO CÁO SẢN XUẤT PHÂN XƯỞNG"]],f.format.horizontalAlignment="Center",u.format.horizontalAlignment="Center",s.format.horizontalAlignment="Left",m.format.horizontalAlignment="Center",m.format.font.bold=!0,m.format.font.size=18,h=n.getRange("B9"),d=n.getRange("B10"),p=n.getRange("D10"),y=n.getRange("F19"),h.values=[["Phân xưởng"]],d.values=[["Từ ngày:"]],p.values=[["Đến ngày:"]],y.values=[["Người lập báo cáo"]],h.format.horizontalAlignment="Left",h.format.font.size=12,h.format.font.italic=!0,y.format.horizontalAlignment="Left",y.format.font.size=12,y.format.font.italic=!0,d.format.horizontalAlignment="Left",d.format.font.size=12,d.format.font.italic=!0,p.format.horizontalAlignment="Left",p.format.font.size=12,p.format.font.italic=!0,(v=n.tables.add("B12:G12",!0)).name="ReportData",v.getHeaderRowRange().values=[["STT","Mã Công Việc","Tên Công Việc","Tổng chỉ tiêu","Sản phẩm đạt","Sản phẩm lỗi"]],v.getHeaderRowRange().format.fill.color="#009879",v.getDataBodyRange().format.fill.color="#FFFFFF",Office.context.requirements.isSetSupported("ExcelApi","1.2")&&(n.getUsedRange().format.autofitColumns(),n.getUsedRange().format.autofitRows(),n.getUsedRange().format.horizontalAlignment="Center"),n.getRange("A2").format.horizontalAlignment="Left",n.getRange("A2").format.font.italic=!0,e.next=58,t.sync();case 58:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 14:return e.next=16,c();case 16:return e.next=18,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){var n,o,r,a,i,c,l,g,s,f,u,m,h,d,p,y,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getActiveWorksheet(),o=n.getRange("A1:B1"),r=n.getRange("E1:H1"),a=n.getRange("E2:H2"),i=n.getRange("B5:G6"),c=n.getRange("A2:C2"),l=new Date,g="Ngày ".concat(l.getDate()," Tháng ").concat(l.getMonth()," Năm ").concat(l.getFullYear()),r.merge(),a.merge(),o.merge(),i.merge(),c.merge(),s=n.getRange("A1"),f=n.getRange("E1"),u=n.getRange("E2"),m=n.getRange("B5"),n.getRange("A2").values=[["".concat(g)]],s.values=[["Công ty Rạng Đông"]],f.values=[["Cộng hòa xã hội chủ nghĩa Việt Nam"]],u.values=[["Độc lập - Tự do - Hạnh phúc"]],m.values=[["BÁO CÁO TIẾN ĐỘ SẢN XUẤT"]],f.format.horizontalAlignment="Center",u.format.horizontalAlignment="Center",s.format.horizontalAlignment="Left",m.format.horizontalAlignment="Center",m.format.font.bold=!0,m.format.font.size=18,h=n.getRange("B9"),d=n.getRange("B10"),p=n.getRange("D10"),y=n.getRange("D19"),h.values=[["Phân xưởng"]],d.values=[["Từ ngày:"]],p.values=[["Đến ngày:"]],y.values=[["Người lập báo cáo"]],h.format.horizontalAlignment="Left",h.format.font.size=12,h.format.font.italic=!0,y.format.horizontalAlignment="Left",y.format.font.size=12,y.format.font.italic=!0,d.format.horizontalAlignment="Left",d.format.font.size=12,d.format.font.italic=!0,p.format.horizontalAlignment="Left",p.format.font.size=12,p.format.font.italic=!0,(v=n.tables.add("B12:E12",!0)).name="ReportData",v.getHeaderRowRange().values=[["Ngày","Chỉ tiêu dự kiến","Tổng SP đạt","Tổng SP lỗi"]],v.getHeaderRowRange().format.fill.color="#009879",v.getDataBodyRange().format.fill.color="#FFFFFF",Office.context.requirements.isSetSupported("ExcelApi","1.2")&&(n.getUsedRange().format.autofitColumns(),n.getUsedRange().format.autofitRows(),n.getUsedRange().format.horizontalAlignment="Center"),n.getRange("A2").format.horizontalAlignment="Left",n.getRange("A2").format.font.italic=!0,e.next=58,t.sync();case 58:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 18:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}function a(){return i.apply(this,arguments)}function i(){return i=o(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Excel.run(function(){var t=o(regeneratorRuntime.mark((function t(n){var o,r,a,i,c,l,g,s,f,u,m,h,d,p,y,v,R,x,k,A,b;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=document.getElementById("id_worker_taskpane").innerHTML,r=document.getElementById("abc").innerHTML,a=document.getElementById("time_taskpane").innerHTML,i=document.getElementById("user-name").innerHTML,c=document.getElementById("task_taskpane").innerHTML,i){t.next=10;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 10:if("Báo cáo sản xuất công nhân"!=i){t.next=16;break}if(o&&a){t.next=14;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 14:t.next=25;break;case 16:if("Báo cáo sản xuất phân xưởng"!=i){t.next=22;break}if(r&&a){t.next=20;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 20:t.next=25;break;case 22:if(r&&c){t.next=25;break}return document.querySelector(".taskpane__error").innerHTML="Bạn cần nhập đủ thông tin",t.abrupt("return");case 25:return document.querySelector(".taskpane__error").innerHTML="",l=n.workbook.worksheets.getActiveWorksheet(),g=[],(s=l.getUsedRange()).load("values"),t.next=32,n.sync();case 32:f=/^[\{]([a-z]|[0-9]|\(|\)|\-|\_|\/)+[\}]$/,u=e(s.values);try{for(u.s();!(m=u.n()).done;){h=m.value,d=e(h);try{for(d.s();!(p=d.n()).done;)y=p.value,f.test(y)&&g.push(y)}catch(e){d.e(e)}finally{d.f()}}}catch(e){u.e(e)}finally{u.f()}if(v=[],"Báo cáo sản xuất công nhân"!=i){t.next=42;break}return R={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({worker:o,time:a,dataClient:g})},t.next=40,fetch("http://localhost:8080/data",R).then((function(e){return e.text()})).then((function(e){console.log("Giá trị Server trả về là : "+e),v.push(JSON.parse(e))}));case 40:t.next=51;break;case 42:if("Báo cáo sản xuất phân xưởng"!=i){t.next=48;break}return x={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({productplant:r,time:a,dataClient:g})},t.next=46,fetch("http://localhost:8080/data",x).then((function(e){return e.text()})).then((function(e){console.log("Giá trị Server trả về là : "+e),v.push(JSON.parse(e))}));case 46:t.next=51;break;case 48:return k={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({productplant:r,task:c,dataClient:g})},t.next=51,fetch("http://localhost:8080/data",k).then((function(e){return e.text()})).then((function(e){console.log("Giá trị Server trả về là : "+e),v.push(JSON.parse(e))}));case 51:console.log("Excel nhận được sau khi fetch xong: "+v),A=0;case 53:if(!(A<v[0].length)){t.next=69;break}return(b=s.find("{".concat(v[0][A].data,"}"),{completeMatch:!0,matchCase:!1,searchDirection:Excel.SearchDirection.forward})).load("address"),t.next=58,n.sync();case 58:if(!b.address){t.next=65;break}return b.values=[["".concat(v[0][A].value)]],b.format.autofitColumns(),t.next=63,n.sync();case 63:t.next=66;break;case 65:return t.abrupt("break",69);case 66:A++,t.next=53;break;case 69:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 2:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function c(){return l.apply(this,arguments)}function l(){return l=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $("select.taskpane__btn").prop("selectedIndex",0),t.workbook.worksheets.getActiveWorksheet().getRange().clear(),e.next=5,t.sync();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("Error: "+e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))}));case 2:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",Office.context.requirements.isSetSupported("ExcelApi","1.7")||console.log("Sorry. The tutorial add-in uses Excel.js APIs that are not available in your version of Office."),$("option[selected]").hide(),$("select.taskpane__btn").on("change",(function(){!function(e){r.apply(this,arguments)}($(this).val())})),document.getElementById("clear-table").onclick=c,document.getElementById("connect-db").onclick=a,document.getElementById("open-dialog").onclick=s)}));var g=null;function s(){Office.context.ui.displayDialogAsync("https://localhost:3000/popup.html",{height:32,width:30},(function(e){(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,f)}))}function f(e){"worker"==e.message?document.getElementById("user-name").innerHTML="Báo cáo sản xuất công nhân":"productplant"==e.message?document.getElementById("user-name").innerHTML="Báo cáo sản xuất phân xưởng":document.getElementById("user-name").innerHTML="Báo cáo tiến độ sản xuất",g.close(),u()}function u(){Office.context.ui.displayDialogAsync("https://localhost:3000/ProductPlant.html",{width:35,height:30},(function(e){e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó"),u()),console.log("Mở dialog 2 thành công"),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,m)}))}function m(e){document.getElementById("abc").innerHTML=e.message,g.close();var t=document.getElementById("user-name").innerHTML;"Báo cáo sản xuất công nhân"==t?(console.log("else 1"),h()):"Báo cáo sản xuất phân xưởng"==t?(console.log("Chuẩn bị mở dialog lấy thời gian"),p()):v()}function h(){var e=document.getElementById("abc").innerHTML;Office.context.ui.displayDialogAsync("https://localhost:3000/Worker.html?id=".concat(e),{width:30,height:36},(function(e){e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó ở Dialog Worker"),h()),console.log("Mở dialog 3 thành công"),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,d),console.log("Nhận event Dialog Worker")}))}function d(e){console.log("test hàm dialog 3"),document.getElementById("id_worker_taskpane").innerHTML=e.message,g.close(),p()}function p(){Office.context.ui.displayDialogAsync("https://localhost:3000/Date.html?",{width:40,height:40},(function(e){console.log("Chạy vào hàm mở dialog 4"),e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó ở Dialog Time"),p()),console.log("Mở dialog 4 thành công"),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,y)}))}function y(e){console.log("test hàm dialog 4"),console.log(e.message),document.getElementById("time_taskpane").innerHTML=e.message,g.close()}function v(){var e=document.getElementById("abc").innerHTML;Office.context.ui.displayDialogAsync("https://localhost:3000/task.html?id=".concat(e),{width:30,height:36},(function(e){e.status===Office.AsyncResultStatus.Failed&&(12007===e.error.code||console.log("Lỗi gì đó ở Dialog Worker"),v()),(g=e.value).addEventHandler(Office.EventType.DialogMessageReceived,R),console.log("Nhận event Dialog Worker")}))}function R(e){console.log(e.message),document.getElementById("task_taskpane").innerHTML=e.message,g.close()}}();
//# sourceMappingURL=taskpane.js.map